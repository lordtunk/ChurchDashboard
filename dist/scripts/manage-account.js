!function(){"use strict";function e(){user&&(s.value=user.username,user.homepage&&(t.value=user.homepage))}function a(){var e="",a=$.trim(s.value),o=$.trim(t.value),m=$.trim(n.value),i=$.trim(u.value),d=$.trim(c.value),l={username:a,homepage:o};return""===a?e+="Username cannot be blank<br />":a.length>100&&(e+="Username cannot exceed 100 characters<br />"),m+i+d!==""&&(""===m||""===i||""===d?e+="To change your password all fields must be filled in<br />":i!=d?e+="New Password and Confirm Password must match<br />":(l.oldPassword=sha256_digest(m),l.newPassword=sha256_digest(i))),e?($().toastmessage("showErrorToast",e),void 0):(r(l),void 0)}function r(e){$(".manage-account-form").mask("Saving..."),$.ajax({type:"POST",url:"ajax/manage-account.php",data:{user:JSON.stringify(e)}}).done(function(e){$(".manage-account-form").unmask();var a=JSON.parse(e);a.success?($().toastmessage("showSuccessToast","Save successful"),n.value="",u.value="",c.value=""):1===a.error?logout():a.exception?$().toastmessage("showErrorToast",a.exception):$().toastmessage("showErrorToast","Error updating account")}).fail(function(){$(".manage-account-form").unmask(),$().toastmessage("showErrorToast","Error updating account")})}var o=document.querySelector("#update"),s=document.querySelector("#username"),t=document.querySelector("#homepage"),n=document.querySelector("#password"),u=document.querySelector("#new-password"),c=document.querySelector("#confirm-password");o.addEventListener("click",a),e()}();