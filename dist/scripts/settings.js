!function(){"use strict";function e(){var e="",a=$.trim(o.value),r=$.trim(l.value);return $.trim(s.value).length>500&&(e+="Email(s) cannot exceed 500 characters<br />"),a.length>500&&(e+="Campus(es) cannot exceed 500 characters<br />"),t(a)||(e+="Campus(es) have incorrect format<br />"),r.length>500&&(e+="Service Label(s) cannot exceed 500 characters<br />"),t(r)||(e+="Service Label(s) have incorrect format<br />"),i.validity.valid||(e+="Default Campus id must be greater than or equal to 1<br />"),u.validity.valid||(e+="Default First Service Label id must be greater than or equal to 1<br />"),n.validity.valid||(e+="Default Second Service Label id must be greater than or equal to 1<br />"),e?($().toastmessage("showErrorToast",e),!1):!0}function t(e){if(0===e.length)return!0;for(var t,a,r=e.split(","),s=0;s<r.length;s++){if(-1===r[s].indexOf("|"))return!1;if(t=r[s].split("|"),a=parseInt(t[0]),isNaN(a)||1>a)return!1;if(""===$.trim(t[1]))return!1}return!0}function a(){e()&&$.ajax({type:"POST",url:"ajax/save_settings.php",data:{startingPointEmails:s.value,campuses:o.value,serviceLabels:l.value,defaultCampus:i.value,defaultFirstServiceLabel:u.value,defaultSecondServiceLabel:n.value}}).done(function(e){var t=JSON.parse(e);t.success?$().toastmessage("showSuccessToast","Settings updated successfully"):1===t.error?logout():2===t.error?window.location="attendance.html":$().toastmessage("showErrorToast","Error updating settings")}).fail(function(){$().toastmessage("showErrorToast","Error updating settings")})}function r(){$.ajax({type:"POST",url:"ajax/get_settings.php"}).done(function(e){var t=JSON.parse(e);t.success?(s.value=t.starting_point_emails,o.value=t.campuses,l.value=t.service_labels,i.value=t.default_campus,u.value=t.default_first_service_label,n.value=t.default_second_service_label):1===t.error?logout():2===t.error?window.location="attendance.html":$().toastmessage("showErrorToast","Error loading settings")}).fail(function(){$().toastmessage("showErrorToast","Error loading settings")})}var s=document.querySelector("#starting-point-emails"),o=document.querySelector("#campuses"),l=document.querySelector("#service-labels"),u=document.querySelector("#default-service-label-first"),n=document.querySelector("#default-service-label-second"),i=document.querySelector("#default-campus");document.getElementById("update").addEventListener("click",a),checkLoginStatus(r)}();