!function(){"use strict";function e(){if(t(p.value,m.value)){var e;e={fromDate:p.value,toDate:m.value,active:$("#active").is(":checked"),not_visited:$("#not-visited").is(":checked"),ty_card_not_sent:!1,signed_up_for_baptism:!1,baptized:!1,interested_in_gkids:!1,interested_in_next:!1,interested_in_ggroups:!1,interested_in_gteams:!1,interested_in_joining:!1,would_like_visit:$("#would-like-visit").is(":checked"),no_agent:!1,commitment_christ:!1,recommitment_christ:!1,commitment_tithe:!1,commitment_ministry:!1,attendance_frequency:!1},r(e)}}function t(e,t){var r="";return c(e,!0)||(r+="From Date must be a valid date<br />"),c(t,!0)||(r+="To Date must be a valid date<br />"),r?($().toastmessage("showErrorToast",r),!1):!0}function r(e){$(".address-view-form").mask("Loading..."),$.ajax({type:"POST",url:"ajax/get_report.php",data:{type:4,params:JSON.stringify(e)}}).done(function(e){var t=JSON.parse(e);t.success?(n(t.people),$(".address-view-form").unmask()):1===t.error?logout():$().toastmessage("showErrorToast","Error searching people")}).fail(function(){$().toastmessage("showErrorToast","Error searching people")})}function a(e,t){if(null===e)return"";var r="";return e.first_name||e.last_name?(e.last_name&&(r+=e.last_name),e.last_name&&e.first_name?t===!0?r+=", "+e.first_name:r=e.first_name+" "+r:e.first_name&&(r+=e.first_name+" ")):r=e.description,r}function n(e){$("#address-view-table tbody tr").remove();for(var t=0;t<e.length;t++)i(e[t])}function i(e){var t=a(e);$("#address-view-table > tbody:last").append('<tr person_id="'+e.id+'"><td data-th="Name" person_name="'+t+'"><a class="person_name" href="manage-person.html?id='+e.id+'">'+t+'</a></td><td data-th="Address">'+d(e)+'</td><td data-th="Visit" class="checkbox-table-col"><label for="visit-checkbox-'+e.id+'"><input id="visit-checkbox-'+e.id+'" class="visit-checkbox" type="checkbox" address="'+o(e)+'" /></label></td></tr>')}function s(){var e,t,r,a=$(".visit-checkbox:checked"),n=h;if(a.length>k.length)return $().toastmessage("showErrorToast","Can't show more than "+k.length+" people at once."),void 0;_.innerHTML="";for(var i=0;i<a.length;i++)r=a[i].getAttribute("address"),"OH"!==r&&""!==r&&(n+=y+k[i]+"|"+r,e=a[i].parentElement.parentElement.previousElementSibling.innerHTML,t=a[i].parentElement.parentElement.previousElementSibling.previousElementSibling.getAttribute("person_name"),_.innerHTML+=' <div class="map-legend-item"><span style="font-weight: bold;">'+k[i]+"</span> : "+t+'<br /><a href="'+b+e+'" target="_blank">'+e+"</a></div>");""!==_.innerHTML?(f.innerHTML='<img border="0" src="'+n+'" />',$("#map-legend")[0].style.setProperty("display","block"),$("#map-note")[0].style.setProperty("display","block")):(f.innerHTML="",$("#map-legend")[0].style.setProperty("display","none"),$("#map-note")[0].style.setProperty("display","none"),$().toastmessage("showWarningToast","Must select at least 1 person with an address"))}function o(e){var t="";return t+=e.street1||"",t+=" ",t+=e.street2||"",t+=" ",t+=e.city||"",t+=" ",t+=e.state||"",t+=" ",t+=e.zip||"",t.trim()}function d(e){var t="";return t+=e.street1||"",e.street1&&(t+="<br />"),t+=e.street2||"",e.street2&&(t+="<br />"),t+=e.city||"",e.city&&e.state&&(t+=","),t+=" ",t+=e.state||"",t+=" ",t+=e.zip||"",t.trim()}function c(e,t){var r=e;if(""===r)return!!t;var a=/^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/,n=r.match(a);if(null===n)return!1;var i=n[1],s=n[3],o=n[5];if(1>i||i>12)return!1;if(1>s||s>31)return!1;if((4==i||6==i||9==i||11==i)&&31==s)return!1;if(2==i){var d=o%4===0&&(o%100!==0||o%400===0);if(s>29||29==s&&!d)return!1}return!0}function l(e){var t=$("#address-view-table-container"),r=-1==e.target.id.indexOf("top")?t[0].scrollHeight:0;t.stop().animate({scrollTop:r},v,"swing",function(){$("<style></style>").appendTo($(document.body)).remove()})}$("#from-date").datepicker(),$("#to-date").datepicker();var m=document.querySelector("#to-date"),p=document.querySelector("#from-date"),u=document.querySelector("#go-arrow"),g=document.querySelector("#gen-map"),v=1e3,f=document.querySelector("#address-map-panel"),_=document.querySelector("#map-legend"),h="//maps.googleapis.com/maps/api/staticmap?zoom=11&size=500x500",b="https://www.google.com/maps/place/",y="&markers=color:red%7Clabel:",k=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","1","2","3","4","5","6","7","8","9","0"];$(".navigation-links a").on("click",l),u.addEventListener("click",e),g.addEventListener("click",s),checkLoginStatus()}();