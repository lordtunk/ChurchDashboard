!function(){"use strict";function s(){editUser&&($("#username").val(editUser.username),$("#is-site-admin").attr("checked","1"==editUser.is_site_admin),$("#is-user-admin").attr("checked","1"==editUser.is_user_admin))}function e(s){var e="";return 0===s.username.length&&(e+="Username cannot be blank<br />"),s.username.length>50&&(e+="Username cannot exceed 50 characters<br />"),editUser||(0===s.password.length&&(e+="Password cannot be blank<br />"),s.password.length>50&&(e+="Password cannot exceed 50 characters<br />"),s.password!=s.confirm_password&&(e+="Passwords do not match<br />")),e?($().toastmessage("showErrorToast",e),!1):!0}function r(){var s=$("#is-site-admin"),r={username:$.trim($("#username").val()),is_user_admin:$("#is-user-admin").is(":checked"),homepage:"index.php"};s.length>0&&(r.is_site_admin=s.is(":checked")),editUser?r.id=editUser.id:(r.password=$("#password").val(),r.confirm_password=$("#confirm-password").val()),e(r)&&(editUser||(r.password=sha256_digest(r.password),r.confirm_password=sha256_digest(r.confirm_password)),$.ajax({type:"POST",url:"ajax/manage_user.php",data:{user:JSON.stringify(r)}}).done(function(s){var e=JSON.parse(s);e.success?editUser?$().toastmessage("showSuccessToast","Save successful"):window.location="index.php":1===e.error?logout():2===e.error?window.location="attendance.php":$().toastmessage("showErrorToast",e.msg||"Error creating user")}).fail(function(){$().toastmessage("showErrorToast","Error creating user")}))}s(),document.getElementById("save").addEventListener("click",r)}();