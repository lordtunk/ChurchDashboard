!function(){"use strict";function e(e){var t=$("#state");$.each(e,function(e,o){t.append("<option value="+o.abbreviation+">"+o.name+"</option>")}),t.val("OH")}function t(){var e=$("#follow-up-frequency");$.each(sn,function(t,o){e.append("<option value="+t+">"+o+"</option>")}),e.val("")}function o(){var e=$("#follow-up-type");$.each(rn,function(t,o){e.append("<option value="+t+">"+o+"</option>")}),e.val("2"),e=$("#relationship-type"),$.each(an,function(t,o){e.append("<option value="+t+">"+o+"</option>")}),e.val("1"),e=$("#attender-status"),$.each(cn,function(t,o){e.append("<option value="+t+">"+o+"</option>")}),e.val("3")}function n(e){kt.value=e.first_name,wt.value=e.last_name,$t.value=e.description,St.innerHTML=e.first_attendance_dt||'<span style="font-style: italic;">(None)</span>',qt.innerHTML=e.last_attendance_dt||'<span style="font-style: italic;">(None)</span>',Et.value=e.attender_status,Tt.checked=e.adult,xt.checked=e.active,At.checked=e.baptized,Lt.checked=e.saved,Ot.checked=e.visitor,Ct.checked=e.assigned_agent,Mt.checked=e.starting_point_notified,Nt.value=e.street1,jt.value=e.street2,Ht.value=e.city,Pt.value=e.zip,e.state&&(Dt.value=e.state),It.value=e.email,Jt.value=_t(e.primary_phone),Ft.value=e.primary_phone_type,zt.value=_t(e.secondary_phone),Rt.value=e.secondary_phone_type,r(e),i(e.campuses),a(e),J(e.follow_ups),R(e.relationships),T()}function r(e){Ut.checked=e.commitment_christ,Yt.checked=e.recommitment_christ,Gt.checked=e.commitment_tithe,Kt.checked=e.commitment_ministry,Vt.checked=e.commitment_baptism,Bt.checked=e.info_next,Zt.checked=e.info_gkids,Qt.checked=e.info_ggroups,Wt.checked=e.info_gteams,Xt.checked=e.info_member,eo.checked=e.info_visit,to.checked=e.info_growth}function i(e){$(".campuses input").prop("checked",!1);for(var t=0;t<e.length;t++)$(".campuses input[campusid="+e[t]+"]").prop("checked",!0)}function a(e){var t=dt(e);tn.innerHTML="OH"===t||""===t?"":'<a href="'+nn+t+'" target="_blank"><img border="0" src="'+on+t+'" /></a>'}function c(){for(var e=$(".campuses input:checked"),t=[],o=0;o<e.length;o++)t.push(e[o].getAttribute("campusid"));var n={id:person.id,first_name:$.trim(kt.value),last_name:$.trim(wt.value),description:$.trim($t.value),attender_status:Et.value,adult:Tt.checked,active:xt.checked,baptized:At.checked,saved:Lt.checked,visitor:Ot.checked,assigned_agent:Ct.checked,street1:$.trim(Nt.value),street2:$.trim(jt.value),city:$.trim(Ht.value),zip:$.trim(Pt.value),state:$.trim(Dt.value),email:$.trim(It.value),primary_phone:$.trim(Jt.value),primary_phone_type:Ft.value,secondary_phone:$.trim(zt.value),secondary_phone_type:Rt.value,commitment_christ:Ut.checked,recommitment_christ:Yt.checked,commitment_tithe:Gt.checked,commitment_ministry:Kt.checked,commitment_baptism:Vt.checked,info_next:Bt.checked,info_gkids:Zt.checked,info_ggroups:Qt.checked,info_gteams:Wt.checked,info_member:Xt.checked,info_visit:eo.checked,info_growth:to.checked,campuses:t};"OH"===$.trim(dt(n))&&(n.state=""),d(n)&&v(n)}function s(){var e=[];return $("#follow-up-table tbody tr").each(function(t,o){var n=o.children[0].getAttribute("typeCd")||"";e.push({id:o.getAttribute("follow_up_id"),typeCd:n,type:rn[n],date:o.children[1].innerHTML||"",comments:o.children[3].innerHTML||"",visitorsIds:o.children[2].getAttribute("visitorsIds").split(",")||"",visitors:o.children[2].innerHTML.split(", ")||""})}),e}function l(){var e=[];return $("#relationship-table tbody tr").each(function(t,o){var n=o.children[0].getAttribute("typeCd")||"";e.push({id:o.getAttribute("relationship_id"),typeCd:n,type:an[n],person_id:person.id,relation_id:o.children[1].getAttribute("relationid"),name:o.children[1].getAttribute("relationname")})}),e}function d(e){var t="",o=!!e.first_name,n=!!e.last_name,r=!!e.description;return!o&&n?t+="First Name cannot be blank if Last Name is specified<br />":o&&!n?t+="Last Name cannot be blank if First Name is specified<br />":o||n||r||(t+="Must specify either First and Last Name or Description<br />"),e.first_name.length>50&&(t+="First Name cannot exceed 50 characters<br />"),e.last_name.length>50&&(t+="Last Name cannot exceed 50 characters<br />"),e.description.length>250&&(t+="Description cannot exceed 250 characters<br />"),e.email.length>100&&(t+="Email cannot exceed 100 characters<br />"),It.checkValidity()||(t+="Email is not valid<br />"),e.primary_phone.length>15?t+="Primary Phone cannot exceed 15 characters<br />":e.primary_phone.length>0&&!en.test(e.primary_phone)&&(t+="Primary Phone is not a valid phone number format<br />"),e.secondary_phone.length>15?t+="Secondary Phone cannot exceed 15 characters<br />":e.secondary_phone.length>0&&!en.test(e.secondary_phone)&&(t+="Secondary Phone is not a valid phone number format<br />"),e.street1.length>100&&(t+="Street 1 cannot exceed 100 characters<br />"),e.street2.length>100&&(t+="Street 2 cannot exceed 100 characters<br />"),e.city.length>100&&(t+="City cannot exceed 100 characters<br />"),e.zip.length>5&&(t+="Zip Code cannot exceed 5 characters<br />"),e.street1.length>100&&(t+="Street 1 cannot exceed 100 characters<br />"),t?($().toastmessage("showErrorToast",t),!1):!0}function u(){confirm("Deleting someone also deletes their attendance history. Continue?")&&_()}function p(){confirm("If you continue you will lose any unsaved changes. Continue?")&&(n(person),Xo=!0)}function m(){var e=$.trim(ko.value);""===e?$().toastmessage("showErrorToast","Must enter Name"):f(e)}function h(){var e=$.trim(ko.value);""===e?$().toastmessage("showErrorToast","Must enter Name"):y(e)}function f(e){$.ajax({type:"POST",url:"ajax/create_person.php",data:{person_display:e}}).done(function(e){var t=JSON.parse(e);t.success?A(t.person_id,t.person_name):1===t.error?logout():$().toastmessage("showErrorToast","Error loading visitors")}).fail(function(){$().toastmessage("showErrorToast","Error loading visitors")})}function y(e){$.ajax({type:"GET",url:"ajax/search.php",data:{search:e}}).done(function(e){var t=JSON.parse(e);t.success?O(t.people):1===t.error?logout():$().toastmessage("showErrorToast","Error loading visitors")}).fail(function(){$().toastmessage("showErrorToast","Error loading visitors")})}function g(){$.ajax({type:"GET",url:"ajax/states.json"}).done(function(t){if($.isArray(t))e(t);else{var o=JSON.parse(t);e(o)}}).fail(function(){$().toastmessage("showErrorToast","Error loading states")})}function v(e){$.ajax({type:"POST",url:"ajax/save_person.php",data:{person:JSON.stringify(e)}}).done(function(t){var o=JSON.parse(t);o.success?(e.follow_ups=s(),e.relationships=l(),person=e,Xo=!0,a(e),$().toastmessage("showSuccessToast","Save successful")):1===o.error?logout():$().toastmessage("showErrorToast","Error saving person")}).fail(function(){$().toastmessage("showErrorToast","Error saving person")})}function _(){$.ajax({type:"POST",url:"ajax/delete_person.php",data:{id:person.id}}).done(function(e){var t=JSON.parse(e);t.success?window.location="attendance.php":1===t.error?logout():$().toastmessage("showErrorToast","Error deleting person")}).fail(function(){$().toastmessage("showErrorToast","Error deleting person")})}function b(e,t){$.ajax({type:"POST",url:"ajax/save_follow_up.php",data:{follow_up:JSON.stringify(e)}}).done(function(o){var n=JSON.parse(o);n.success?(e.id=n.follow_up_id,w(n.communication_card_options[0]),r(n.communication_card_options[0]),t.call(this,e),$().toastmessage("showSuccessToast","Follow up save successful")):1===n.error?logout():n.warning?$().toastmessage("showErrorToast",n.warning):$().toastmessage("showErrorToast","Error saving follow up")}).fail(function(){$().toastmessage("showErrorToast","Error saving follow up")})}function k(e){$.ajax({type:"POST",url:"ajax/delete_follow_up.php",data:{id:e,personId:person.id}}).done(function(t){var o=JSON.parse(t);o.success?($("#follow-up-table tr[follow_up_id="+e+"]").remove(),w(o.communication_card_options[0]),r(o.communication_card_options[0])):1===o.error?logout():o.warning?$().toastmessage("showErrorToast",o.warning):$().toastmessage("showErrorToast","Error deleting follow up")}).fail(function(){$().toastmessage("showErrorToast","Error deleting follow up")})}function w(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]="true"===e[t])}function S(e,t){$.ajax({type:"POST",url:"ajax/save_relationship.php",data:{relationship:JSON.stringify(e)}}).done(function(o){var n=JSON.parse(o);if(n.success)e.id=n.relationship_id,t.call(this,e),T(),$().toastmessage("showSuccessToast","Relationship save successful");else if(1===n.error)logout();else{var r="Error saving relationship";n.msg&&(r=n.msg),$().toastmessage("showErrorToast",r)}}).fail(function(){$().toastmessage("showErrorToast","Error saving relationship")})}function q(e){$.ajax({type:"POST",url:"ajax/delete_relationship.php",data:{id:e}}).done(function(t){var o=JSON.parse(t);o.success?($("#relationship-table tr[relationship_id="+e+"]").remove(),T()):1===o.error?logout():$().toastmessage("showErrorToast","Error deleting relationship")}).fail(function(){$().toastmessage("showErrorToast","Error deleting relationship")})}function E(){$.ajax({type:"POST",url:"ajax/copy_address_to_spouse.php",data:{personId:person.id}}).done(function(e){var t=JSON.parse(e);t.success?$().toastmessage("showSuccessToast","Address copied successful"):1===t.error?logout():$().toastmessage("showErrorToast","Error copying address")}).fail(function(){$().toastmessage("showErrorToast","Error copying address")})}function T(){ao.style.display=$("#relationship-table td[typecd=1]").length>0?"":"none"}function x(e){var t=e.currentTarget.parentElement.parentElement,o=t.getAttribute("person_id"),n=t.children[0].getAttribute("person_name");A(o,n)}function A(e,t){N(),fo.innerHTML='<a class="person_name" href="manage-person.php?id='+e+'">'+t+"</a>",fo.setAttribute("relationid",e),fo.setAttribute("person_name",t)}function L(e){var t=e.currentTarget.parentElement.parentElement,o=t.getAttribute("person_id");window.location="manage-person.php?id="+o}function O(e){$("a.person_name").off("click",x),$("button.search-button").off("click",L),$("#search-table tbody tr").remove();for(var t=0;t<e.length;t++)C(e[t]);$("a.person_name").on("click",x),$("button.search-button").on("click",L)}function C(e){var t=H(e);$("#search-table > tbody:last").append('<tr person_id="'+e.id+'"><td data-th="Name" person_name="'+t+'"><a class="person_name" href="javascript:void(0);">'+t+'</a></td><td data-th="Address">'+j(e)+'</td><td data-th="" class="search-table-button-col"><button class="search-button btn btn-xs btn-info">Manage</button></td></tr>')}function M(){vo.dialog("open")}function N(){vo.dialog("close")}function j(e){var t="";return t+=e.street1||"",e.street1&&(t+="<br />"),t+=e.street2||"",e.street2&&(t+="<br />"),t+=e.city||"",e.city&&e.state&&(t+=","),t+=" ",t+=e.state||"",t+=" ",t+=e.zip||"",t.trim()}function H(e,t){if(null===e)return"";var o="";return e.first_name||e.last_name?(e.last_name&&(o+=e.last_name),e.last_name&&e.first_name?t===!0?o+=", "+e.first_name:o=e.first_name+" "+o:e.first_name&&(o+=e.first_name+" ")):o=e.description,o}function P(){Mo.value="2",No.value="",No.disabled=!1,jo.checked=!1,Qo.value="",Jo.checked=!1,zo.checked=!1,Fo.checked=!1,Ro.checked=!1,Do.checked=!1,Uo.checked=!1,Yo.checked=!1,Go.checked=!1,Ko.checked=!1,Vo.checked=!1,Bo.checked=!1,Zo.checked=!1,mt();var e=$("#relationship-table td[typecd=1]");Lo.style.display=e.length>0?"inherit":"none",Oo.checked=e.length>0;for(var t=Ho.querySelectorAll("input"),o=0;o<t.length;o++)t[o].checked=!1}function I(){var e=$.trim(No.value),t=$.trim(Mo.value),o=$.trim(Qo.value),n=[],r=[],i={frequency:Po.value,commitment_christ:!1,recommitment_christ:!1,commitment_tithe:!1,commitment_ministry:!1,commitment_baptism:!1,info_next:!1,info_gkids:!1,info_ggroups:!1,info_gteams:!1,info_member:!1,info_visit:!1,info_growth:!1},a="",c="";""!==o||1!=t&&2!=t||(a+="Must specify comments<br />"),""!==e||jo.checked||(a+="Must specify a date or mark it unknown<br />"),o.length>5e3&&(a+="Comments cannot exceed 5000 characters<br />");for(var s=Ho.querySelectorAll("input"),l=0;l<s.length;l++)s[l].checked&&(n.push($.trim(s[l].nextSibling.innerHTML)),r.push(s[l].getAttribute("personid")));if(0===r.length&&(a+="Must specify a visitor<br />"),a)return $().toastmessage("showErrorToast",a),!1;var d=$("#relationship-table td[typecd=1]");return d.length>0&&Oo.checked&&-1===Ao.dialog("option","title").indexOf("Edit")&&(c=d.next()[0].getAttribute("relationid")),3==t&&(i={frequency:Po.value,commitment_christ:Jo.checked,recommitment_christ:zo.checked,commitment_tithe:Fo.checked,commitment_ministry:Ro.checked,commitment_baptism:Do.checked,info_next:Uo.checked,info_gkids:Yo.checked,info_ggroups:Go.checked,info_gteams:Ko.checked,info_member:Vo.checked,info_visit:Bo.checked,info_growth:Zo.checked}),{id:-1===Ao.dialog("option","title").indexOf("Edit")?gt():Co.value,personId:person.id,add_to_spouse:!!c,spouseId:c,date:e,typeCd:t,type:Mo.selectedOptions[0].text,comments:o,visitors:n,visitorsIds:r,communication_card_options:i}}function J(e){yt(),$("#follow-up-table tbody tr").remove();for(var t=0;t<e.length;t++)z(e[t]);ft()}function z(e){!e.type&&e.typeCd&&(e.type=rn[e.typeCd]||""),e.date=e.date||"";var t=[];for(var o in e.communication_card_options)e.communication_card_options.hasOwnProperty(o)&&e.communication_card_options[o]===!0&&t.push(o);$("#follow-up-table > tbody:last").append('<tr follow_up_id="'+e.id+'" communication_card_options="'+t.join(",")+'" frequency="'+e.communication_card_options.frequency+'"><td data-th="Type" typeCd="'+e.typeCd+'">'+e.type+'</td><td data-th="Date" class="follow-up-table-date-col">'+e.date+'</td><td data-th="By" visitorsIds="'+e.visitorsIds.join(",")+'">'+e.visitors.join(", ")+'</td><td data-th="Comments" class="follow-up-table-comments-col">'+e.comments+'</td><td data-th="" class="follow-up-table-button-col"><button class="edit-follow-up"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></button><button class="delete-follow-up"><span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span></button></td></tr>')}function F(e){var t=$("#follow-up-table tr[follow_up_id="+e.id+"]"),o=t.children(),n=[];for(var r in e.communication_card_options)e.communication_card_options.hasOwnProperty(r)&&e.communication_card_options[r]===!0&&n.push(r);t[0].setAttribute("frequency",e.communication_card_options.frequency),t[0].setAttribute("communication_card_options",n.join(",")),o[0].setAttribute("typeCd",e.typeCd),o[0].innerHTML=e.type,o[1].innerHTML=e.date,o[2].innerHTML=e.visitors.join(", "),o[2].setAttribute("visitorsIds",e.visitorsIds.join(",")),o[3].innerHTML=e.comments}function R(e){yt(),$("#relationship-table tbody tr").remove();for(var t=0;t<e.length;t++)D(e[t]);ft()}function D(e){!e.type&&e.typeCd&&(e.type=an[e.typeCd]||""),$("#relationship-table > tbody:last").append('<tr relationship_id="'+e.id+'"><td data-th="Type" typeCd="'+e.typeCd+'">'+e.type+'</td><td data-th="Name" relationId="'+e.relation_id+'" relationname="'+e.name+'"><a class="person_name" href="manage-person.php?id='+e.relation_id+'">'+e.name+'</a></td><td data-th="" class="relationship-table-button-col"><button class="edit-relationship"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></button><button class="delete-relationship"><span class="glyphicon glyphicon-minus-sign" aria-hidden="true"></span></button></td></tr>')}function U(e){var t=$("#relationship-table tr[relationship_id="+e.id+"]").children();t[0].setAttribute("typeCd",e.typeCd),t[0].innerHTML=e.type,t[1].innerHTML=e.name}function Y(){if(""===Ho.innerHTML.trim())for(var e,t=0;t<visitors.length;t++)e=visitors[t],Ho.innerHTML+='<div class="check-field"><input type="checkbox" personid="'+e.id+'" id="follow-up-by-'+e.id+'"/><label for="follow-up-by-'+e.id+'">'+H(e)+"</label></div>"}function G(){co.dialog("open"),V(),co.dialog("option","title","Add Relationship"),uo.innerHTML=H(person)}function K(){co.dialog("close")}function V(){lo.value="1",fo.innerHTML="(Select a person)",fo.setAttribute("relationid",""),fo.setAttribute("person_name",""),yo.style.display="none"}function B(){var e=W();return e===!1?!1:(S(e,function(e){D(e),$("button.edit-relationship:last").on("click",X),$("button.delete-relationship:last").on("click",et),co.dialog("close")}),void 0)}function Z(){var e=W();return e===!1?!1:(S(e,function(e){U(e),co.dialog("close")}),void 0)}function Q(){-1===co.dialog("option","title").indexOf("Edit")?B():Z()}function W(){var e=$.trim(lo.value),t=fo.getAttribute("relationid"),o="",n="";if(t?t==person.id&&(o+="Person cannot have a relationship with themself<br />"):o+="Must select a person<br />",o)return $().toastmessage("showErrorToast",o),!1;var r=$("#relationship-table td[typecd=1]");return r.length>0&&"2"===e&&go.checked&&(n=r.next()[0].getAttribute("relationid")),{id:-1===co.dialog("option","title").indexOf("Edit")?vt():so.value,spouseId:n,typeCd:e,type:lo.selectedOptions[0].text,person_id:person.id,relation_id:t,name:fo.getAttribute("person_name")}}function X(e){co.dialog("open");var t=e.currentTarget.parentElement.parentElement;lo.value=t.children[0].getAttribute("typeCd")||"",so.value=t.getAttribute("relationship_id"),A(t.children[1].getAttribute("relationid"),t.children[1].getAttribute("relationname")),co.dialog("option","title","Edit Relationship")}function et(e){if(confirm("Are you sure you would like to PERMANENTLY delete this Relationship?")){var t=e.currentTarget.parentElement.parentElement.getAttribute("relationship_id");q(t)}}function tt(){Ao.dialog("open"),P(),Y(),Ao.dialog("option","title","Add Follow Up")}function ot(){Ao.dialog("close")}function nt(e){var t=I();return t===!1?!1:(b(t,function(t){z(t),$("button.edit-follow-up:last").on("click",st),$("button.delete-follow-up:last").on("click",lt),Xo=!1,e.call(this)}),void 0)}function rt(e){var t=I();return t===!1?!1:(b(t,function(t){F(t),Xo=!1,e.call(this)}),void 0)}function it(){-1===Ao.dialog("option","title").indexOf("Edit")?nt():rt()}function at(){-1===Ao.dialog("option","title").indexOf("Edit")?nt(P):rt(P)}function ct(){-1===Ao.dialog("option","title").indexOf("Edit")?nt(ot):rt(ot)}function st(e){Ao.dialog("open"),Lo.style.display="none",Y();var t,o=e.currentTarget.parentElement.parentElement,n=o.children[1].innerHTML||"",r=(o.getAttribute("communication_card_options")||"").split(","),i={commitment_christ:!1,recommitment_christ:!1,commitment_tithe:!1,commitment_ministry:!1,commitment_baptism:!1,info_next:!1,info_gkids:!1,info_ggroups:!1,info_gteams:!1,info_member:!1,info_visit:!1};for(t=0;t<r.length;t++)i[r[t]]=!0;Po.value=o.getAttribute("frequency")||"",Mo.value=o.children[0].getAttribute("typeCd")||"",No.value=n,Qo.value=o.children[3].innerHTML||"",Co.value=o.getAttribute("follow_up_id"),jo.checked=""===n,Jo.checked=i.commitment_christ,zo.checked=i.recommitment_christ,Fo.checked=i.commitment_tithe,Ro.checked=i.commitment_ministry,Do.checked=i.commitment_baptism,Uo.checked=i.info_next,Yo.checked=i.info_gkids,Go.checked=i.info_ggroups,Ko.checked=i.info_gteams,Vo.checked=i.info_member,Bo.checked=i.info_visit,Zo.checked=i.info_growth,No.disabled=jo.checked;var a=o.children[2].getAttribute("visitorsIds")||"",c=a.split(","),s=Ho.querySelectorAll("input");for(t=0;t<s.length;t++)s[t].checked=c.indexOf(s[t].getAttribute("personid"))>=0;mt(),Ao.dialog("option","title","Edit Follow Up")}function lt(e){if(confirm("Are you sure you would like to PERMANENTLY delete this Follow Up?")){var t=e.currentTarget.parentElement.parentElement.getAttribute("follow_up_id");k(t)}}function dt(e){var t="";return t+=e.street1||"",t+=" ",t+=e.street2||"",t+=" ",t+=e.city||"",t+=" ",t+=e.state||"",t+=" ",t+=e.zip||"",t.trim()}function ut(e){No.disabled=e.currentTarget.checked,No.value=""}function pt(){var e=$.trim(lo.value);if("2"===e){var t=$("#relationship-table td[typecd=1]");yo.style.display=t.length>0?"inherit":"none",go.checked=!0}else yo.style.display="none"}function mt(){$("#follow-up-frequency-container").css("display",3==Mo.value?"inherit":"none"),Io.style.display=3==Mo.value?"inherit":"none"}function ht(e){Xo||confirm("If you continue you will lose any unsaved changes. Continue?")||e.preventDefault()}function ft(){$("#attendance-nav").on("click",ht),$("#reports-nav").on("click",ht),$("button.edit-follow-up").on("click",st),$("button.delete-follow-up").on("click",lt),$("button.edit-relationship").on("click",X),$("button.delete-relationship").on("click",et)}function yt(){$("#attendance-nav").off("click",ht),$("#reports-nav").off("click",ht),$("button.edit-follow-up").off("click",st),$("button.delete-follow-up").off("click",lt),$("button.edit-relationship").off("click",X),$("button.delete-relationship").off("click",et)}function gt(){return Wo--}function vt(){return So--}function _t(e){if(e=e||"",null===e.match(/\D/g,"")){var t=e.replace(/\D/g);7===t.length?e=t.substr(0,3)+"-"+t.substr(3):10===t.length&&(e="("+t.substr(0,3)+") "+t.substr(3,3)+"-"+t.substr(6))}return e}$("#follow-up-date").datepicker();var bt={},kt=document.querySelector("#first-name"),wt=document.querySelector("#last-name"),$t=document.querySelector("#description"),St=document.querySelector("#first-recorded-visit"),qt=document.querySelector("#last-recorded-visit"),Et=document.querySelector("#attender-status"),Tt=document.querySelector("#adult"),xt=document.querySelector("#active"),At=document.querySelector("#baptized"),Lt=document.querySelector("#saved"),Ot=document.querySelector("#visitor"),Ct=document.querySelector("#assigned-agent"),Mt=document.querySelector("#starting-point-notified"),Nt=document.querySelector("#street1"),jt=document.querySelector("#street2"),Ht=document.querySelector("#city"),Pt=document.querySelector("#zip"),It=document.querySelector("#email"),Jt=document.querySelector("#primary-phone"),zt=document.querySelector("#secondary-phone"),Ft=document.querySelector("#primary-phone-type"),Rt=document.querySelector("#secondary-phone-type"),Dt=document.querySelector("#state"),Ut=document.querySelector("#commitment-christ"),Yt=document.querySelector("#recommitment-christ"),Gt=document.querySelector("#commitment-tithe"),Kt=document.querySelector("#commitment-ministry"),Vt=document.querySelector("#commitment-baptism"),Bt=document.querySelector("#info-next"),Zt=document.querySelector("#info-gkids"),Qt=document.querySelector("#info-ggroups"),Wt=document.querySelector("#info-gteams"),Xt=document.querySelector("#info-member"),eo=document.querySelector("#info-visit"),to=document.querySelector("#info-growth"),oo=document.querySelector("#update"),no=document.querySelector("#cancel"),ro=document.querySelector("#delete"),io=document.querySelector("#add-follow-up"),ao=document.querySelector("#copy-address-to-spouse"),co=$(".manage-person-relationship-form").dialog({autoOpen:!1,height:400,width:350,modal:!0,open:function(){$("body").css({overflow:"hidden"})},beforeClose:function(){$("body").css({overflow:"inherit"})}}),so=co[0].querySelector("#relationship-id"),lo=co[0].querySelector("#relationship-type"),uo=co[0].querySelector("#relationship-person-name"),po=document.querySelector("#add-relationship"),mo=document.querySelector("#add-close-relationship"),ho=document.querySelector("#close-relationship"),fo=document.querySelector("#relationship-relation"),yo=co[0].querySelector("#add-to-spouse-container-relationship"),go=co[0].querySelector("#add-to-spouse-relationship"),vo=$(".select-person-form").dialog({autoOpen:!1,height:400,width:350,modal:!0,open:function(){$("body").css({overflow:"hidden"})},beforeClose:function(){$("body").css({overflow:"inherit"})}}),_o=document.querySelector("#add-new-person"),bo=document.querySelector("#search"),ko=document.querySelector("#search-name"),wo=vo[0].querySelector("#close-select-person"),$o=document.querySelector("#select-person-btn"),So=-1,qo=document.querySelector("#add-clear"),Eo=document.querySelector("#add-copy"),To=document.querySelector("#add-close"),xo=document.querySelector("#close"),Ao=$(".manage-person-follow-up-form").dialog({autoOpen:!1,height:410,width:350,modal:!0,open:function(){$("body").css({overflow:"hidden"})},beforeClose:function(){$("body").css({overflow:"inherit"})}}),Lo=Ao[0].querySelector("#add-to-spouse-container-follow-up"),Oo=Ao[0].querySelector("#add-to-spouse-follow-up"),Co=Ao[0].querySelector("#follow-up-id"),Mo=Ao[0].querySelector("#follow-up-type"),No=Ao[0].querySelector("#follow-up-date"),jo=document.querySelector("#manage-unknown-date"),Ho=Ao[0].querySelector("#follow-up-visitors"),Po=Ao[0].querySelector("#follow-up-frequency"),Io=Ao[0].querySelector(".communication-card-options"),Jo=Ao[0].querySelector("#follow-up-commitment-christ"),zo=Ao[0].querySelector("#follow-up-recommitment-christ"),Fo=Ao[0].querySelector("#follow-up-commitment-tithe"),Ro=Ao[0].querySelector("#follow-up-commitment-ministry"),Do=Ao[0].querySelector("#follow-up-commitment-baptism"),Uo=Ao[0].querySelector("#follow-up-info-next"),Yo=Ao[0].querySelector("#follow-up-info-gkids"),Go=Ao[0].querySelector("#follow-up-info-ggroups"),Ko=Ao[0].querySelector("#follow-up-info-gteams"),Vo=Ao[0].querySelector("#follow-up-info-member"),Bo=Ao[0].querySelector("#follow-up-info-visit"),Zo=Ao[0].querySelector("#follow-up-info-growth"),Qo=Ao[0].querySelector("#follow-up-comments"),Wo=-1,Xo=!0,en=/^((\(?([2-9][0-8][0-9])\))|([2-9][0-8][0-9]))?[-. ]?([2-9][0-9]{2})[-. ]?([0-9]{4})$/,tn=document.querySelector("#map-panel"),on="//maps.googleapis.com/maps/api/staticmap?zoom=11&size=400x400&markers=color:red%7Clabel:A|",nn="https://www.google.com/maps/place/",rn={1:"Phone Call",2:"Visit",3:"Communication Card",4:"Entered in The City",5:"Thank You Card Sent"},an={1:"Spouse",2:"Child",3:"Parent"},cn={1:"Member",2:"Regular",3:"Irregular"},sn={1:"1st Time",2:"2nd Time",3:"Often",4:"Member","":"--None Provided--"};apiKey&&(on+="&key="+apiKey),(window.onpopstate=function(){var e,t=/\+/g,o=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(t," "))},r=window.location.search.substring(1);for(bt={};null!==(e=o.exec(r));)bt[n(e[1])]=n(e[2])}).call(),bt.id||(window.location="attendance.php"),oo.addEventListener("click",c),no.addEventListener("click",p),ro.addEventListener("click",u),io.addEventListener("click",tt),Eo.addEventListener("click",it),qo.addEventListener("click",at),To.addEventListener("click",ct),xo.addEventListener("click",ot),ao.addEventListener("click",E),$("#follow-up-type").on("change",mt),po.addEventListener("click",G),mo.addEventListener("click",Q),ho.addEventListener("click",K),$("#relationship-type").on("change",pt),$o.addEventListener("click",M),_o.addEventListener("click",m),bo.addEventListener("click",h),ko.addEventListener("keydown",function(e){13==e.keyCode&&h()}),wo.addEventListener("click",N),$("#manage-unknown-date").on("change",ut),g(),o(),t(),n(person)}();